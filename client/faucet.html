<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>EOSTime Faucet</title>
    <link rel="icon" href="favicon.ico">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/10.2.1/css/bootstrap-slider.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css">
</head>
<body>
<style type="text/css">
    body {
        padding-top: 5rem;
        background: black;
        color: white;
    }
    .grey-text {
        color: #aaaaaa;
    }
    .no-user-select {
        -webkit-user-select: none; /* Safari */
        -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* IE10+/Edge */
        user-select: none; /* Standard */
    }
    .uiBlocker {
        position: absolute;
        top: 0px;
        left: 0px;
        width: 100%;
        height: 100%;
        z-index: 5000;
        border-radius: .3rem;
        background-color: #007bff78;
        padding: 10px;
    }
    .uiBlocker div {
        position: relative;
        top: 50%;
        transform: translateY(-50%);
        text-align: center;
    }
    .uiBlocker img {
        width: 75px;
        height: auto;
    }
    footer {
        background-color: rgba(255,255,255,0.2);
        font-size: 8pt;
        padding-bottom: 0px;
        padding-top: 4px;
        line-height: 2.2;
        padding-right: 20px;
        padding-left: 20px;
    }
    .dev-clear-errors {
        line-height: 1;
        color: #99dbff;
        cursor: pointer;
    }
    .dev-error-message {
        color: #ff999b;
    }
</style>

<script type="text/javascript">

    window.addEventListener('load', function(event) {

        var animationTimer = null;

        $( document ).on("updateTimeTillDraw", function(event) {
            var timeTillDraw = event.detail;

            // timeTillDraw is an object that looks like this:
            //
            // {hours: "01", minutes: "05", seconds: "09"}
            //
            // This object should update your time till next draw UI element. You will only
            // receive these while the user is eligible to draw (or just prior to a
            // canDrawNow => false message);
            $(".next-draw-hours").text(timeTillDraw.hours);
            $(".next-draw-minutes").text(timeTillDraw.minutes);
            $(".next-draw-seconds").text(timeTillDraw.seconds);
        });

        $( document ).on("canDrawNow", function(event) {
            var canDraw = event.detail;

            // canDraw is a boolean that indicates whether or not the user
            // can currently draw or not. Should update your UI accordly
            if (canDraw) {
                $(".cannot-draw-now").addClass("d-none");
                $(".can-draw-now").removeClass("d-none");
            } else {
                $(".cannot-draw-now").removeClass("d-none");
                $(".can-draw-now").addClass("d-none");
            }
        });

        // Do this and we will attempt to draw.
        $(".draw-button").on("click", function(event) {

            if (!animationTimer) {
                animationTimer = setInterval(function() {
                    var randomValue = Math.floor(Math.random()*10000);
                    $(".draw-button").text(randomValue.toString());
                }, 100);
            }

            // Let the animation play for a couple of seconds just for kicks,
            // this is demo only, you would not do this in the real page.
            setTimeout(function() {
                var evt = new CustomEvent("faucetDraw", {});
                document.dispatchEvent(evt);
            }, 2000);
        });

        $( document ).on("faucetAward", function(event) {
            var award = event.detail;
            console.log(award);

            // awardAmount is a float indicating the EOS awarded by the faucet. Do
            // whatever you want (animation, set a value someplace, or nothing). The
            // user's EOS balance would have already been updated.
            //
            // A value of 0 for award.eosAward and award.randomDraw indicates that
            // the request was made before the waiting period expired.
            //
            $(".draw-button").text("Draw");
            if (animationTimer) {
                clearInterval(animationTimer);
                animationTimer = null;
            }

            $(".next-draw-hours").text(award.nextDraw.hours);
            $(".next-draw-minutes").text(award.nextDraw.minutes);
            $(".next-draw-seconds").text(award.nextDraw.seconds);

            if (award.eosAward == 0) {
                alert("Can't draw again for " + award.nextDraw.nextDrawSecs + " seconds!");
            } else {
                alert("You just got " + award.eosAward + " for a roll of " + award.randomDraw + " in the faucet!");
            }
        });

    });

</script>

<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
    <a class="navbar-brand" href="#">EOSTime</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" href="#">Faucet <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link disabled" href="#">Disabled</a>
            </li>
        </ul>
        <form class="form-inline my-2 my-lg-0">
            <div class="cpu-gauge d-none"><canvas width="40" height="40"></canvas></div>
            <div class="net-gauge d-none pl-2 pr-2"><canvas width="40" height="40"></canvas></div>
            <div class="developer-mode d-none" style="position: relative; cursor: pointer;">
                <a class="nav-link dropdown-toggle" id="network_selector" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Network</a>
                <div class="dropdown-menu" aria-labelledby="dropdown01">
                    <a id="select_mainnet" class="dropdown-item" href="#">Main Net</a>
                    <a id="select_jungle" class="dropdown-item" href="#">Jungle</a>
                </div>
            </div>
            <button class="login-button logged-out-view d-none btn btn-outline-success my-2 my-sm-0" type="button">Log In</button>
            <button class="logout-button logged-in-view d-none btn btn-outline-success my-2 my-sm-0" type="button">Log Out</button>
        </form>
    </div>
</nav>

<!-- Dev Mode Footer -->
<footer class="fixed-bottom developer-mode d-none">
    <div class="row">
        <div id="dev_error_message_container" class="col-5 text-left"></div>
        <div class="col-7 text-right">
            <b>DEVELOPER MODE</b> -- Current Key: <span class="account-name"></span> [<span class="public-key"></span>]
        </div>
    </div>
</footer>
<div class="dev-error-message-row-template row pb-1 d-none">
    <div class="dev-clear-errors col-1 text-left" style="line-height: 1;"></div>
    <div class="dev-error-message col-11 text-left" style="line-height: 1;"></div>
</div>

<main id="faucet_container" roll="main" class="container">

    <div>EOS Balance: <span class="eos-balance"></span></div>
    <div>TIME Balance: <span class="coin-balance"></span></div>
    <div class="logged-in-view">
        <div class="cannot-draw-now pt-1 d-none">Content you want shown when the user cannot draw</div>
        <div class="cannot-draw-now d-none">Next Draw Time:
                <span class="next-draw-hours"></span>:<span class="next-draw-minutes"></span>:<span class="next-draw-seconds"></span>
        </div>
        <div class="can-draw-now pt-1 d-none">Content you want shown only when the user can draw.</div>
        <button type="button" class="draw-button can-draw-now d-none btn btn-primary">Draw</button>
    </div>

</main>

<!-- Scripting needed to support the eosroller app -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/10.2.1/bootstrap-slider.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://cdn.scattercdn.com/file/scatter-cdn/js/latest/scatterjs-core.min.js"></script>
<script src="https://cdn.scattercdn.com/file/scatter-cdn/js/latest/scatterjs-plugin-eosjs2.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js"></script>
<script src="https://cdn.jsdelivr.net/npm/eosjs@16.0.0/lib/eos.min.js" integrity="sha512-vNyLnOEb7uFmEtVbLnyZQ9/k4zckM2Vu3jJOKq6XfWEVZG0yKcjDExVN4EQ7e3F+rePWRncMolI2xFi/3qo62A==" crossorigin="anonymous"></script>
<script src="js/eostime-bundle.min.js"></script>
</body>
</html>